<!-- ================= HEADER ================= -->
<div class="page-header">
  <h1>Candidates</h1>

  <div class="header-actions">
    <button
      class="secondary-btn"
      routerLink="/dashboard">
      ðŸ“ˆ Dashboard
    </button>
    <button
      class="primary-btn"
      *ngIf="role === 'HR' || role === 'RECRUITER'"
      routerLink="/candidates/add">
      + Add Candidate
    </button>
  </div>
</div>

<!-- ================= FILTER BAR ================= -->
<div class="filter-bar" *ngIf="role !== 'INTERVIEWER'">
  <input
    type="text"
    placeholder="Search by name"
    [(ngModel)]="searchText"
    (ngModelChange)="groupCandidatesByStatus()"
  />

  <input
    type="text"
    placeholder="Filter by skill / tag"
    [(ngModel)]="filterTag"
    (ngModelChange)="groupCandidatesByStatus()"
  />
</div>

<!-- ================= CANDIDATES LIST ================= -->
<div class="candidates-container">
  <ng-container *ngFor="let status of statuses">
    <div class="status-section" *ngIf="candidatesByStatus[status]?.length">
      <h2 class="status-title">
        {{ status }}
        <span class="count">{{ candidatesByStatus[status]?.length }}</span>
      </h2>
      
      <div class="cards-grid">
        <div class="candidate-card" *ngFor="let candidate of candidatesByStatus[status]">
          <div class="card-header">
            <h3 (click)="openCandidate(candidate._id)">{{ candidate.name }}</h3>
            <select 
              *ngIf="role === 'HR' || role === 'RECRUITER'"
              class="status-dropdown"
              [(ngModel)]="candidate.currentStatus"
              (change)="changeStatus(candidate, candidate.currentStatus)"
              (click)="$event.stopPropagation()">
              <option value="APPLIED">APPLIED</option>
              <option value="SHORTLISTED">SHORTLISTED</option>
              <option value="INTERVIEW_SCHEDULED">INTERVIEW_SCHEDULED</option>
              <option value="INTERVIEWED">INTERVIEWED</option>
              <option value="SELECTED">SELECTED</option>
              <option value="REJECTED">REJECTED</option>
            </select>
            <span *ngIf="role === 'INTERVIEWER'" class="status-badge" [ngClass]="candidate.currentStatus">{{ candidate.currentStatus }}</span>
          </div>
          
          <p class="role" (click)="openCandidate(candidate._id)">{{ candidate.roleApplied }}</p>
          
          <div class="tags" *ngIf="candidate.tags?.length" (click)="openCandidate(candidate._id)">
            <span class="tag" *ngFor="let tag of candidate.tags">{{ tag }}</span>
          </div>
          
          <div class="interview-info" *ngIf="candidate.interviewDate" (click)="openCandidate(candidate._id)">
            ðŸ“… {{ candidate.interviewDate | date:'short' }}
          </div>
        </div>
      </div>
    </div>
  </ng-container>
</div>
